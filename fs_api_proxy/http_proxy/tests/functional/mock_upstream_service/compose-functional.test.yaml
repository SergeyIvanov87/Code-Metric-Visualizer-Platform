include:
  - ../../../../../common/images/test_pseudo_fs/compose.yaml

services:
  fs-api-http-proxy-functional-tester-service-a:
    build:
      context: ../../../../../
      dockerfile: fs_api_proxy/http_proxy/tests/functional/mock_upstream_service/Dockerfile
      additional_contexts:
        test_pseudo_fs: "service:test_pseudo_fs"
    environment:
        - UPSTREAM_SERVICE=mock-upstream-service
        - DOWNSTREAM_SERVICE=service_a
        - DOWNSTREAM_SERVICE_NETWORK_ADDR=stub-downstream-service-network-addr
        - EXIT_ONCE_DONE=true
        - PYTEST_FILTER=${PYTEST_FILTER:-}
    networks:
      - api.pmccabe_collector.service.network
    volumes:
      - api.pmccabe_collector.restapi.org.fs-api-http-proxy.test:/api
    depends_on:
      - http-proxy-service-a

volumes:
  api.pmccabe_collector.restapi.org.fs-api-http-proxy.test:
