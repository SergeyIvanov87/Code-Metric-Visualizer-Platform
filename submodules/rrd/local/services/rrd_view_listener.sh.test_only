#!/usr/bin/bash

. ${1}/setenv.sh
rrdtool -h > /mnt/api.pmccabe_collector.restapi.org/project/{uuid}/analytic/rrd/select/view/help 2>&1
shopt -s extglob
inotifywait -m /mnt/api.pmccabe_collector.restapi.org/project/{uuid}/analytic/rrd/select/view/GET -e access --include 'exec$' |
	while read dir action file; do
		echo "file: ${file}, action; ${action}, dir: ${dir}"
		case "$action" in
			ACCESS|ATTRIB )
				"${WORK_DIR}/rrd_view_exec.sh" /mnt/api.pmccabe_collector.restapi.org/project/{uuid}/analytic/rrd/select/view ${WORK_DIR} /mnt/api.pmccabe_collector.restapi.org/project/{uuid}/analytic/rrd/select/view/GET/${file}
			;;
			*)
				;;
		esac
	done
